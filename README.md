# Pose Annotator: æ™ºèƒ½å§¿æ€ä¸ç›®æ ‡æ£€æµ‹æ ‡æ³¨å¹³å°

![Version](https://img.shields.io/badge/version-1.3.0-blue.svg)
![License](https://img.shields.io/badge/license-ISC-green.svg)
![React](https://img.shields.io/badge/Frontend-React-61DAFB.svg)
![Node](https://img.shields.io/badge/Backend-Node.js-339933.svg)
![Electron](https://img.shields.io/badge/Desktop-Electron-47848F.svg)

**Pose Annotator** æ˜¯ä¸€ä¸ªä¸“ä¸ºè®¡ç®—æœºè§†è§‰ä»»åŠ¡è®¾è®¡çš„ç°ä»£ã€é«˜æ€§èƒ½æ ‡æ³¨å·¥å…·ã€‚å®ƒç»“åˆäº† Web çš„çµæ´»æ€§ä¸åŸç”Ÿåº”ç”¨çš„å¼ºå¤§æ€§èƒ½ï¼Œæ”¯æŒ **ç›®æ ‡æ£€æµ‹ (Bounding Box)** å’Œ **å§¿æ€ä¼°è®¡ (Keypoint)** ä¸¤ç§æ ‡æ³¨æ¨¡å¼ï¼Œå¹¶æ·±åº¦é›†æˆäº† YOLOv8-Pose çš„æ•°æ®æ ¼å¼å¯¼å‡ºä¸æ¨¡å‹è®­ç»ƒæµç¨‹ã€‚

---

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### ğŸš€ æè‡´æ€§èƒ½
- **ç™¾ä¸‡çº§å›¾åº“æ”¯æŒ**ï¼šåç«¯é›†æˆ `sharp` é«˜æ€§èƒ½å›¾åƒå¤„ç†å¼•æ“ï¼Œæ”¯æŒå®æ—¶ç”Ÿæˆç¼©ç•¥å›¾ï¼Œæµè§ˆæµ·é‡æ•°æ®é›†æµç•…æ— å¡é¡¿ã€‚
- **åŸç”Ÿç³»ç»Ÿé›†æˆ**ï¼šåŸºäº Electron æ„å»ºï¼Œæä¾›åŸç”Ÿæ–‡ä»¶ç³»ç»Ÿè®¿é—®ã€ç›®å½•é€‰æ‹©å™¨ç­‰æ¡Œé¢çº§ä½“éªŒã€‚

### ğŸ¯ ä¸“ä¸šæ ‡æ³¨ä½“éªŒ
- **å¤šæ¨¡å¼æ ‡æ³¨**ï¼šæ”¯æŒçŸ©å½¢æ¡† (BBox) ä¸ å…³é”®ç‚¹ (Pose) æ··åˆæ ‡æ³¨ã€‚
- **æ™ºèƒ½è¾…åŠ©**ï¼š
  - **åå­—è¾…åŠ©çº¿**ï¼šåƒç´ çº§å¯¹é½ã€‚
  - **è‡ªåŠ¨æ ‡ç­¾**ï¼šæ”¯æŒç±»åˆ« ID è®°å¿†ä¸å¿«é€Ÿåˆ‡æ¢ã€‚
  - **è‡ªåŠ¨ä¿å­˜**ï¼šæ‰€æœ‰æ“ä½œå®æ—¶ä¿å­˜è‡³æœ¬åœ° JSON æ–‡ä»¶ï¼Œé˜²æ­¢æ•°æ®ä¸¢å¤±ã€‚
- **ç°ä»£åŒ– UI**ï¼šé‡‡ç”¨ Glassmorphismï¼ˆæ¯›ç»ç’ƒï¼‰è®¾è®¡é£æ ¼ï¼Œç•Œé¢ç®€æ´ç›´è§‚ï¼Œå‡å°‘è§†è§‰ç–²åŠ³ã€‚

### ğŸ“Š æ•°æ®ç®¡ç†ä¸å¯¼å‡º
- **é¡¹ç›®éš”ç¦»**ï¼šæ”¯æŒå¤šé¡¹ç›®ç®¡ç†ï¼Œæ•°æ®ç›¸äº’ç‹¬ç«‹ã€‚
- **é«˜çº§å¯¼å‡º**ï¼š
  - **YOLO Pose æ ¼å¼ç›´å‡º**ï¼šä¸€é”®ç”Ÿæˆæ ‡å‡† YOLOv8-Pose æ•°æ®é›†ç»“æ„ (`images`, `labels`, `data.yaml`)ã€‚
  - **æ•°æ®é›†åˆ’åˆ†**ï¼šæ”¯æŒè‡ªå®šä¹‰ **Train/Val/Test** æ¯”ä¾‹ï¼ˆå¦‚ 8:1:1ï¼‰ã€‚
  - **éšæœºæ‰“ä¹±**ï¼šå†…ç½® Fisher-Yates æ´—ç‰Œç®—æ³•ï¼Œç¡®ä¿æ•°æ®é›†åˆ†å¸ƒå‡åŒ€ã€‚
  - **çµæ´»é…ç½®**ï¼šæ”¯æŒå¯¼å‡ºæ˜¯å¦åŒ…å«ä¸å¯è§ç‚¹ (Visibility Flag)ï¼Œæ”¯æŒç­›é€‰ä»…å·²æ ‡æ³¨å›¾ç‰‡ã€‚
  - **å¯¼å‡ºè·¯å¾„å±•ç¤º**ï¼šå¯¼å‡ºå®Œæˆåå¼¹çª—æ˜¾ç¤ºå®Œæ•´ä¿å­˜è·¯å¾„ã€‚

### ğŸ¤– AI æ¨¡å‹è®­ç»ƒé›†æˆ
- **YOLOv8-Pose æ”¯æŒ**ï¼šå†…ç½® YOLOv8n-pose/s-pose/m-pose/l-pose/x-pose æ¨¡å‹é€‰é¡¹ã€‚
- **å†…ç½®è®­ç»ƒ UI**ï¼šæ— éœ€ç¼–å†™ä»£ç ï¼Œç›´æ¥åœ¨ç•Œé¢é…ç½® Epochs, Batch Size, Model ç­‰å‚æ•°ã€‚
- **å®æ—¶ç›‘æ§**ï¼šè®­ç»ƒæ—¥å¿—å®æ—¶å›æ˜¾ï¼Œéšæ—¶æŒæ¡è®­ç»ƒè¿›åº¦ï¼ˆéœ€é…ç½® Python ç¯å¢ƒï¼‰ã€‚
- **æ•°æ®é›†çŠ¶æ€æ£€æµ‹**ï¼šè®­ç»ƒç•Œé¢è‡ªåŠ¨æ£€æµ‹æ•°æ®é›†æ˜¯å¦å·²å¯¼å‡ºï¼Œæ˜¾ç¤ºå…³é”®ç‚¹é…ç½®ä¿¡æ¯ã€‚

---

## ğŸ†• v1.3.0 æ›´æ–°å†…å®¹

### æ–°å¢åŠŸèƒ½
- **YOLOv8-Pose æ¨¡å‹æ”¯æŒ**ï¼šä¿®å¤è®­ç»ƒæ—¶æ¨¡å‹é€‰æ‹©é—®é¢˜ï¼Œç°åœ¨é»˜è®¤ä½¿ç”¨ `yolov8n-pose.pt` ç­‰ Pose æ¨¡å‹ã€‚
- **å¯¼å‡ºè·¯å¾„å¼¹çª—**ï¼šæ•°æ®é›†å¯¼å‡ºå®Œæˆåæ˜¾ç¤ºè¯¦ç»†å¼¹çª—ï¼ŒåŒ…å«å¯¼å‡ºç»Ÿè®¡ä¿¡æ¯å’Œå®Œæ•´ä¿å­˜è·¯å¾„ã€‚
- **è®­ç»ƒç•Œé¢æ•°æ®é›†çŠ¶æ€**ï¼šå®æ—¶æ˜¾ç¤ºæ•°æ®é›†æ˜¯å¦å·²å¯¼å‡ºã€å…³é”®ç‚¹æ•°é‡ã€data.yaml è·¯å¾„ç­‰ä¿¡æ¯ã€‚
- **å›¾ç‰‡åˆ é™¤åŠŸèƒ½**ï¼š
  - å›¾åº“ç•Œé¢ï¼šé¼ æ ‡æ‚¬åœæ˜¾ç¤ºåˆ é™¤æŒ‰é’®ï¼Œæ”¯æŒæ‰¹é‡ç®¡ç†ã€‚
  - ç¼–è¾‘å™¨ç•Œé¢ï¼šå·¥å…·æ æ–°å¢åˆ é™¤æŒ‰é’®ï¼Œæ”¯æŒåˆ é™¤å½“å‰å›¾ç‰‡ã€‚
  - è‡ªåŠ¨é‡æ–°ç¼–å·ï¼šåˆ é™¤å›¾ç‰‡åè‡ªåŠ¨é‡æ–°ç¼–å·ä¿æŒè¿ç»­ï¼ˆ000001, 000002...ï¼‰ã€‚

### ä¿®å¤é—®é¢˜
- ä¿®å¤ä½¿ç”¨æ™®é€šæ£€æµ‹æ¨¡å‹è®­ç»ƒ Pose æ•°æ®é›†å¯¼è‡´çš„æ ¼å¼é”™è¯¯ã€‚
- ä¿®å¤åˆ é™¤å›¾ç‰‡åç•Œé¢ä¸åˆ·æ–°çš„é—®é¢˜ã€‚

---

## ğŸ–¼ï¸ ç•Œé¢é¢„è§ˆ

| é¡¹ç›®å·¥ä½œå° (Dashboard) | æ ‡æ³¨ç¼–è¾‘å™¨ (Editor) |
| :---: | :---: |
| ![Dashboard](./docs/images/dashboard.png) | ![Editor](./docs/images/editor.png) |
| ç°ä»£åŒ–é¡¹ç›®ç®¡ç†ç•Œé¢ï¼Œæ”¯æŒ ZIP æŒç»­åä½œã€‚ | å¼ºå¤§çš„æ ‡æ³¨å·¥å…·ï¼Œæ”¯æŒå‚ç›´è¾…åŠ©çº¿ä¸å®æ—¶ä¿å­˜ã€‚ |

| æ•°æ®é›†å¯¼å‡º (Dataset Export) |
| :---: |
| ![Export](./docs/images/export.png) |
| ç‹¬ç«‹çš„å¯¼å‡ºé…ç½®é¡µé¢ï¼Œæ”¯æŒ Train/Val/Test è‡ªç”±åˆ’åˆ†ã€‚ |

---

## ğŸ› ï¸ ç¯å¢ƒå‡†å¤‡

åœ¨å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ‚¨çš„ç¯å¢ƒæ»¡è¶³ä»¥ä¸‹è¦æ±‚ï¼š

*   **Node.js**: v16+ (æ¨è v18 æˆ–æ›´é«˜)
*   **Python**: 3.8+ (ä»…ä½¿ç”¨è®­ç»ƒåŠŸèƒ½æ—¶éœ€è¦ï¼Œéœ€å®‰è£… `ultralytics` åº“)

---

## ğŸ“¦ å®‰è£…æŒ‡å—

1.  **å…‹éš†æˆ–ä¸‹è½½é¡¹ç›®**
    ```bash
    git clone [repository-url]
    cd pose-annotator
    ```

2.  **å®‰è£…ä¾èµ–**
    é¡¹ç›®é‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œéœ€è¦åˆ†åˆ«å®‰è£…ä¾èµ–ï¼š

    ```bash
    # 1. å®‰è£…æ ¹ç›®å½•ä¾èµ– (Electron & Backend)
    npm install

    # 2. å®‰è£…å‰ç«¯ä¾èµ– (React Client)
    cd client
    npm install
    cd ..
    ```

---

## ğŸš€ å¿«é€Ÿå¯åŠ¨

æˆ‘ä»¬æä¾›äº†å¤šç§å¯åŠ¨æ–¹å¼ä»¥é€‚åº”ä¸åŒçš„å¼€å‘ä¸ä½¿ç”¨åœºæ™¯ï¼š

### æ–¹å¼ Aï¼šæ¡Œé¢å®¢æˆ·ç«¯æ¨¡å¼ï¼ˆæ¨èï¼‰
è¿™æ˜¯æœ€å®Œæ•´çš„ä½“éªŒæ–¹å¼ï¼Œåœ¨ä¸€ä¸ªçª—å£ä¸­åŒæ—¶è¿è¡Œåç«¯æœåŠ¡ä¸å‰ç«¯ç•Œé¢ã€‚

```bash
npm run electron:dev
```
> **æ³¨æ„**ï¼šå¯åŠ¨åä¼šå¼¹å‡ºä¸€ä¸ª Electron çª—å£ï¼ŒåŒ…å«æ‰€æœ‰åŠŸèƒ½ã€‚

### æ–¹å¼ Bï¼šæ‰“åŒ…æ„å»ºï¼ˆWindowsï¼‰
å¦‚æœæ‚¨æƒ³ç”Ÿæˆå¯åˆ†å‘çš„ `.exe` å®‰è£…åŒ…ï¼š

```bash
npm run electron:build
```
æ„å»ºäº§ç‰©å°†ä½äº `dist/` ç›®å½•ä¸‹ã€‚

### æ–¹å¼ Cï¼šWeb å¼€å‘æ¨¡å¼
å¦‚æœæ‚¨éœ€è¦è°ƒè¯•å‰ç«¯æˆ–åç«¯ä»£ç ï¼š

1.  **å¯åŠ¨åç«¯** (http://localhost:5000)
    ```bash
    npm start
    ```
2.  **å¯åŠ¨å‰ç«¯** (http://localhost:5173)
    ```bash
    npm run client:dev
    ```

---

## ğŸ“– ä½¿ç”¨æŒ‡å—

### 1. åˆ›å»ºé¡¹ç›®
å¯åŠ¨åº”ç”¨åï¼Œç‚¹å‡»é¦–é¡µçš„ **"New Project"** å¡ç‰‡ï¼Œè¾“å…¥é¡¹ç›®åç§°ï¼ˆæ”¯æŒä¸­æ–‡ï¼‰ã€‚é¡¹ç›®æ•°æ®å°†å­˜å‚¨åœ¨ `projects/` ç›®å½•ä¸‹ã€‚
> **æç¤º**ï¼šå¦‚æœæ˜¯æ—§ç‰ˆæœ¬ç”¨æˆ·ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å°† `uploads/` ä¸‹çš„æ•°æ®è¿ç§»è‡³ `projects/Default_Project/`ã€‚

### 2. å¯¼å…¥å›¾ç‰‡
è¿›å…¥é¡¹ç›®åï¼Œç‚¹å‡»å³ä¸Šè§’çš„ **Upload** æŒ‰é’®æˆ–ç›´æ¥æ‹–æ‹½å›¾ç‰‡åˆ°çª—å£ä¸­ã€‚æ”¯æŒ JPG, PNG, WEBP ç­‰å¸¸è§æ ¼å¼ã€‚

### 3. è¿›è¡Œæ ‡æ³¨
*   **åˆ‡æ¢æ¨¡å¼**ï¼šåœ¨é¡¶éƒ¨å·¥å…·æ åˆ‡æ¢ **BBox** (çŸ©å½¢æ¡†) æˆ– **Pose** (å…³é”®ç‚¹) æ¨¡å¼ã€‚
*   **å¿«æ·é”®**ï¼š
    *   `Delete` / `Backspace`: åˆ é™¤é€‰ä¸­çš„æ ‡æ³¨ã€‚
    *   `A` / `D` æˆ– `â†` / `â†’`: åˆ‡æ¢ä¸Šä¸€å¼ /ä¸‹ä¸€å¼ å›¾ç‰‡ã€‚
*   **å…³é”®ç‚¹é€»è¾‘**ï¼šå…³é”®ç‚¹å¿…é¡»å½’å±äºæŸä¸ªçŸ©å½¢æ¡†ã€‚å…ˆç”»æ¡†ï¼Œå†åœ¨æ¡†å†…ç‚¹é€‰å…³é”®ç‚¹ã€‚
*   **åˆ é™¤å›¾ç‰‡**ï¼šåœ¨å›¾åº“æˆ–ç¼–è¾‘å™¨ä¸­ç‚¹å‡»åˆ é™¤æŒ‰é’®ï¼Œåˆ é™¤åè‡ªåŠ¨é‡æ–°ç¼–å·ã€‚

### 4. å¯¼å‡ºæ•°æ®
ç‚¹å‡» **Export** æŒ‰é’®ï¼Œæ‰“å¼€å¯¼å‡ºé…ç½®é¢æ¿ï¼š
*   **Path**: é€‰æ‹©å¯¼å‡ºç›®å½•ï¼ˆæ”¯æŒæ–°å»ºæ–‡ä»¶å¤¹ï¼‰ã€‚
*   **Split Ratio**: è®¾ç½®è®­ç»ƒé›†ã€éªŒè¯é›†ã€æµ‹è¯•é›†çš„æ¯”ä¾‹ã€‚
*   **Keypoints**: è®¾ç½®å…³é”®ç‚¹æ•°é‡ï¼ˆé»˜è®¤ä¸º 17ï¼Œå¯¹åº” COCO æ ¼å¼ï¼‰ã€‚
*   å¯¼å‡ºå®Œæˆåä¼šæ˜¾ç¤ºå®Œæ•´è·¯å¾„å¼¹çª—ã€‚

### 5. æ¨¡å‹è®­ç»ƒ
ç‚¹å‡» **Train** æŒ‰é’®ï¼Œè¿›å…¥è®­ç»ƒé…ç½®é¡µé¢ï¼š
*   ç•Œé¢ä¼šæ˜¾ç¤ºæ•°æ®é›†çŠ¶æ€ï¼ˆæ˜¯å¦å·²å¯¼å‡ºã€å…³é”®ç‚¹æ•°é‡ï¼‰ã€‚
*   é€‰æ‹© Pose æ¨¡å‹ï¼ˆyolov8n-pose ~ yolov8x-poseï¼‰ã€‚
*   é…ç½®å‚æ•°åç‚¹å‡» **Start Training**ã€‚
*   **ä¾èµ–æç¤º**ï¼šè¯·ç¡®ä¿ Python ç¯å¢ƒå·²å®‰è£… YOLOv8 (`pip install ultralytics`)ã€‚

---

## ğŸ“‚ ç›®å½•ç»“æ„

```text
pose-annotator/
â”œâ”€â”€ client/                      # React å‰ç«¯åº”ç”¨
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/          # UI ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ AnnotationEditor.jsx      # æ ‡æ³¨ç¼–è¾‘å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ ClassInputModal.jsx       # ç±»åˆ«è¾“å…¥å¼¹çª—
â”‚   â”‚   â”‚   â”œâ”€â”€ ClassManagerModal.jsx    # ç±»åˆ«ç®¡ç†å¼¹çª—
â”‚   â”‚   â”‚   â”œâ”€â”€ DatasetExport.jsx         # æ•°æ®é›†å¯¼å‡ºé¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ ImageGallery.jsx          # å›¾ç‰‡ç”»å»Š
â”‚   â”‚   â”‚   â”œâ”€â”€ ImageUpload.jsx           # å›¾ç‰‡ä¸Šä¼ 
â”‚   â”‚   â”‚   â”œâ”€â”€ TrainingConfig.jsx        # è®­ç»ƒé…ç½®é¢æ¿
â”‚   â”‚   â”‚   â””â”€â”€ training/                 # è®­ç»ƒç›¸å…³ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ context/              # React Context
â”‚   â”‚   â”‚   â””â”€â”€ ProjectContext.jsx
â”‚   â”‚   â”œâ”€â”€ hooks/                # è‡ªå®šä¹‰ Hooks
â”‚   â”‚   â”‚   â””â”€â”€ useTraining.js
â”‚   â”‚   â””â”€â”€ App.jsx               # åº”ç”¨å…¥å£
â”‚   â””â”€â”€ package.json              # å‰ç«¯ä¾èµ–é…ç½®
â”œâ”€â”€ projects/                     # [è‡ªåŠ¨ç”Ÿæˆ] é¡¹ç›®æ•°æ®å­˜å‚¨ç›®å½•
â”‚   â””â”€â”€ MyProject/
â”‚       â”œâ”€â”€ uploads/              # åŸå§‹å›¾ç‰‡
â”‚       â”œâ”€â”€ annotations/          # JSON æ ‡æ³¨æ–‡ä»¶
â”‚       â”œâ”€â”€ thumbnails/           # ç¼©ç•¥å›¾ç¼“å­˜
â”‚       â””â”€â”€ dataset/              # å¯¼å‡ºçš„ YOLO æ ¼å¼æ•°æ®é›†
â”‚           â”œâ”€â”€ images/           # å›¾ç‰‡ç›®å½•
â”‚           â”‚   â”œâ”€â”€ train/
â”‚           â”‚   â”œâ”€â”€ val/
â”‚           â”‚   â””â”€â”€ test/
â”‚           â”œâ”€â”€ labels/           # æ ‡ç­¾ç›®å½•
â”‚           â””â”€â”€ data.yaml         # YOLO é…ç½®æ–‡ä»¶
â”œâ”€â”€ scripts/                      # è¾…åŠ©è„šæœ¬
â”‚   â””â”€â”€ train.py                  # YOLOv8 è®­ç»ƒè„šæœ¬
â”œâ”€â”€ docs/                         # é¡¹ç›®æ–‡æ¡£
â”‚   â””â”€â”€ images/                   # ç•Œé¢æˆªå›¾
â”œâ”€â”€ dist/                         # [è‡ªåŠ¨ç”Ÿæˆ] æ„å»ºäº§ç‰©
â”œâ”€â”€ server.js                     # Node.js åç«¯æœåŠ¡
â”œâ”€â”€ electron-main.js              # Electron ä¸»è¿›ç¨‹
â”œâ”€â”€ package.json                  # é¡¹ç›®ä¾èµ–é…ç½®
â””â”€â”€ README.md                     # é¡¹ç›®è¯´æ˜
```

---

## ğŸ“‹ æ•°æ®æ ¼å¼

### æ ‡æ³¨æ–‡ä»¶æ ¼å¼ (JSON)
æ¯å¼ å›¾ç‰‡å¯¹åº”ä¸€ä¸ª JSON æ–‡ä»¶ï¼Œä½äº `projects/{project}/annotations/`ï¼š

```json
[
  {
    "id": 1701234567890,
    "type": "bbox",
    "x": 100,
    "y": 150,
    "width": 200,
    "height": 300,
    "classIndex": 0,
    "label": "person"
  },
  {
    "id": 1701234567891,
    "type": "keypoint",
    "x": 150,
    "y": 180,
    "keypointIndex": 0,
    "parentId": 1701234567890
  }
]
```

### YOLO Pose æ ‡ç­¾æ ¼å¼
å¯¼å‡ºçš„æ ‡ç­¾æ–‡ä»¶æ ¼å¼ï¼š
```
<class_id> <cx> <cy> <w> <h> <kp1_x> <kp1_y> <kp1_v> <kp2_x> <kp2_y> <kp2_v> ...
```

### data.yaml é…ç½®
```yaml
path: /path/to/dataset
train: images/train
val: images/val
test: images/test
kpt_shape: [17, 3]
flip_idx: [0, 1, 2, 4, 3, 6, 5, 8, 7, 10, 9, 12, 11, 14, 13, 16, 15]
names:
  0: person
```

---

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ **ISC License** è®¸å¯è¯ã€‚

---

## ğŸ™ è‡´è°¢

- [YOLOv8](https://github.com/ultralytics/ultralytics) - å¼ºå¤§çš„ç›®æ ‡æ£€æµ‹ä¸å§¿æ€ä¼°è®¡æ¡†æ¶
- [React](https://react.dev/) - ç°ä»£ Web å‰ç«¯æ¡†æ¶
- [Electron](https://www.electronjs.org/) - è·¨å¹³å°æ¡Œé¢åº”ç”¨æ¡†æ¶
- [sharp](https://sharp.pixelplumbing.com/) - é«˜æ€§èƒ½å›¾åƒå¤„ç†åº“
